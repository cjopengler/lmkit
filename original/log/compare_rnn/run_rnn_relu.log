Using cuDNN version 5110 on context None
Mapped name None to device cuda3: Tesla K40m (0000:30:00.0)
Namespace(batch_size=20, bptt=-1, goto_line=0, maxlen=256, mode='train', model_dir='None', optimizer='adam', rnn_cell='rnnblock', save_freq=20000, test_file='../data/wikitext-2/idx_wiki.test.tokens', test_freq=2000, train_file='../data/wikitext-2/idx_wiki.train.tokens', valid_file='../data/wikitext-2/idx_wiki.valid.tokens', valid_freq=1000, vocab_size=33279)
loading dataset...
building model...
building rnn cell...
66048
building softmax output layer...
training start...
epoch: 0 idx: 50 cost: 10.5293869972 ppl: 37398.5419453
epoch: 0 idx: 100 cost: 9.78099370956 ppl: 17694.2270424
epoch: 0 idx: 150 cost: 8.39130002975 ppl: 4408.5452104
epoch: 0 idx: 200 cost: 7.53386472702 ppl: 1870.31982946
epoch: 0 idx: 250 cost: 7.44859589577 ppl: 1717.44997282
epoch: 0 idx: 300 cost: 7.45129073143 ppl: 1722.08446004
epoch: 0 idx: 350 cost: 7.34765690804 ppl: 1552.55448474
epoch: 0 idx: 400 cost: 7.23984642029 ppl: 1393.87988276
epoch: 0 idx: 450 cost: 7.218770895 ppl: 1364.81053393
epoch: 0 idx: 500 cost: 7.26517642975 ppl: 1429.63783616
epoch: 0 idx: 550 cost: 7.13107639313 ppl: 1250.22197325
epoch: 0 idx: 600 cost: 7.16500712395 ppl: 1293.37081467
epoch: 0 idx: 650 cost: 7.05888437271 ppl: 1163.14680335
epoch: 0 idx: 700 cost: 7.05384418488 ppl: 1157.29907419
epoch: 0 idx: 750 cost: 7.05022755623 ppl: 1153.12111282
epoch: 0 idx: 800 cost: 7.00787405014 ppl: 1105.3021883
epoch: 0 idx: 850 cost: 6.94043567657 ppl: 1033.22026678
epoch: 0 idx: 900 cost: 6.9495028019 ppl: 1042.63120503
epoch: 0 idx: 950 cost: 6.9387651062 ppl: 1031.49564057
epoch: 0 idx: 1000 cost: 6.95438516617 ppl: 1047.73415747
validing....
valid_cost: 6.5719377479 perplexity: 714.753514221
epoch: 0 idx: 1050 cost: 6.82710651398 ppl: 922.517655031
epoch: 0 idx: 1100 cost: 6.8658803463 ppl: 958.989711342
epoch: 0 idx: 1150 cost: 6.75928186417 ppl: 862.022923904
epoch: 0 idx: 1200 cost: 6.85420310974 ppl: 947.85649076
epoch: 0 idx: 1250 cost: 6.95430002213 ppl: 1047.64495295
epoch: 0 idx: 1300 cost: 6.71578217506 ppl: 825.329066311
epoch: 0 idx: 1350 cost: 6.72006375313 ppl: 828.870352875
epoch: 0 idx: 1400 cost: 6.68367944717 ppl: 799.254523156
epoch: 0 idx: 1450 cost: 6.73718942642 ppl: 843.187561741
epoch: 0 idx: 1500 cost: 6.70931143761 ppl: 820.005819846
epoch: 0 idx: 1550 cost: 6.66401970863 ppl: 783.694839019
epoch: 0 idx: 1600 cost: 6.62984407425 ppl: 757.364068873
epoch: 0 idx: 1650 cost: 6.6297652626 ppl: 757.304382117
epoch: 0 idx: 1700 cost: 6.55252721786 ppl: 701.013551043
epoch: 0 idx: 1750 cost: 6.62361351967 ppl: 752.659940587
epoch: 1 idx: 1800 cost: 0.904750213623 ppl: 2.47131454525
epoch: 1 idx: 1850 cost: 6.41121268272 ppl: 608.631310391
epoch: 1 idx: 1900 cost: 6.35232089043 ppl: 573.82294493
epoch: 1 idx: 1950 cost: 6.16546651363 ppl: 476.023162439
epoch: 1 idx: 2000 cost: 6.22544733047 ppl: 505.449094677
validing....
valid_cost: 6.12898380821 perplexity: 458.969522562
testing...
test cost: 6.05521140076 perplexity: 426.329022209
epoch: 1 idx: 2050 cost: 6.36378960609 ppl: 580.441839691
epoch: 1 idx: 2100 cost: 6.40212850571 ppl: 603.127432778
epoch: 1 idx: 2150 cost: 6.35009049416 ppl: 572.544518602
epoch: 1 idx: 2200 cost: 6.25770601273 ppl: 522.020058154
epoch: 1 idx: 2250 cost: 6.28637878418 ppl: 537.20446927
epoch: 1 idx: 2300 cost: 6.30445555687 ppl: 547.003694695
epoch: 1 idx: 2350 cost: 6.19617178917 ppl: 490.866299942
epoch: 1 idx: 2400 cost: 6.21575768471 ppl: 500.575123657
epoch: 1 idx: 2450 cost: 6.16595748901 ppl: 476.256935476
epoch: 1 idx: 2500 cost: 6.15396956444 ppl: 470.581688437
epoch: 1 idx: 2550 cost: 6.10739240646 ppl: 449.165944564
epoch: 1 idx: 2600 cost: 6.11848626137 ppl: 454.176669116
epoch: 1 idx: 2650 cost: 6.03247560501 ppl: 416.745450523
epoch: 1 idx: 2700 cost: 6.06890705109 ppl: 432.208042026
epoch: 1 idx: 2750 cost: 6.07141330719 ppl: 433.292624623
epoch: 1 idx: 2800 cost: 6.09026364326 ppl: 441.53780427
epoch: 1 idx: 2850 cost: 6.0379099369 ppl: 419.016348435
epoch: 1 idx: 2900 cost: 6.03286580086 ppl: 416.908094597
epoch: 1 idx: 2950 cost: 5.94581752777 ppl: 382.151653216
epoch: 1 idx: 3000 cost: 6.07345562935 ppl: 434.178452016
validing....
valid_cost: 5.87697019577 perplexity: 356.726790391
epoch: 1 idx: 3050 cost: 6.09243595123 ppl: 442.498002907
epoch: 1 idx: 3100 cost: 5.96887367249 ppl: 391.064955382
epoch: 1 idx: 3150 cost: 5.97658738136 ppl: 394.093181011
epoch: 1 idx: 3200 cost: 5.92548536301 ppl: 374.46014036
epoch: 1 idx: 3250 cost: 5.96703300476 ppl: 390.34579681
epoch: 1 idx: 3300 cost: 6.01278648376 ppl: 408.620349351
epoch: 1 idx: 3350 cost: 5.99407828331 ppl: 401.046861995
epoch: 1 idx: 3400 cost: 5.93247065544 ppl: 377.085011017
epoch: 1 idx: 3450 cost: 5.92588699341 ppl: 374.610565142
epoch: 1 idx: 3500 cost: 5.88340377808 ppl: 359.029220051
epoch: 1 idx: 3550 cost: 5.97911226273 ppl: 395.089476774
epoch: 2 idx: 3600 cost: 1.6683954525 ppl: 5.30365100624
epoch: 2 idx: 3650 cost: 5.82120426178 ppl: 337.378100639
epoch: 2 idx: 3700 cost: 5.72312373638 ppl: 305.858854698
epoch: 2 idx: 3750 cost: 5.68149307728 ppl: 293.387152756
epoch: 2 idx: 3800 cost: 5.72603463173 ppl: 306.750474892
epoch: 2 idx: 3850 cost: 5.88026974678 ppl: 357.905772619
epoch: 2 idx: 3900 cost: 5.9015374279 ppl: 365.599118292
epoch: 2 idx: 3950 cost: 5.83884832382 ppl: 343.383646088
epoch: 2 idx: 4000 cost: 5.81732514381 ppl: 336.071906267
validing....
valid_cost: 5.69600198591 perplexity: 297.674910273
testing...
test cost: 5.60808167211 perplexity: 272.620760058
epoch: 2 idx: 4050 cost: 5.81626265526 ppl: 335.715023338
epoch: 2 idx: 4100 cost: 5.81344380379 ppl: 334.770025081
epoch: 2 idx: 4150 cost: 5.78641819954 ppl: 325.843824146
epoch: 2 idx: 4200 cost: 5.69532979012 ppl: 297.474881687
epoch: 2 idx: 4250 cost: 5.69963120461 ppl: 298.757200368
epoch: 2 idx: 4300 cost: 5.71021573067 ppl: 301.936198155
epoch: 2 idx: 4350 cost: 5.63917783737 ppl: 281.231405448
epoch: 2 idx: 4400 cost: 5.72203645706 ppl: 305.526481414
epoch: 2 idx: 4450 cost: 5.55813658714 ppl: 259.339129922
epoch: 2 idx: 4500 cost: 5.60250149727 ppl: 271.103725147
epoch: 2 idx: 4550 cost: 5.695358181 ppl: 297.483327381
epoch: 2 idx: 4600 cost: 5.67544230461 ppl: 291.617293698
epoch: 2 idx: 4650 cost: 5.63431854248 ppl: 279.868134068
epoch: 2 idx: 4700 cost: 5.60357240677 ppl: 271.394208214
epoch: 2 idx: 4750 cost: 5.56429624557 ppl: 260.941500341
epoch: 2 idx: 4800 cost: 5.64458693504 ppl: 282.756735199
epoch: 2 idx: 4850 cost: 5.67722141266 ppl: 292.136574163
epoch: 2 idx: 4900 cost: 5.57409416199 ppl: 263.51074944
epoch: 2 idx: 4950 cost: 5.61114395142 ppl: 273.456880532
epoch: 2 idx: 5000 cost: 5.57404034615 ppl: 263.496568769
validing....
valid_cost: 5.61514388162 perplexity: 274.552879466
epoch: 2 idx: 5050 cost: 5.55936184883 ppl: 259.65708297
epoch: 2 idx: 5100 cost: 5.67676109314 ppl: 292.002128942
epoch: 2 idx: 5150 cost: 5.6261468792 ppl: 277.59046476
epoch: 2 idx: 5200 cost: 5.59547710419 ppl: 269.206058795
epoch: 2 idx: 5250 cost: 5.54467269897 ppl: 255.870817756
epoch: 2 idx: 5300 cost: 5.57124575615 ppl: 262.761231855
epoch: 2 idx: 5350 cost: 5.632732687 ppl: 279.424655392
epoch: 3 idx: 5400 cost: 2.31668022156 ppl: 10.1419493326
epoch: 3 idx: 5450 cost: 5.52784351349 ppl: 251.600751949
epoch: 3 idx: 5500 cost: 5.40783122063 ppl: 223.147105663
epoch: 3 idx: 5550 cost: 5.30927320957 ppl: 202.203215609
epoch: 3 idx: 5600 cost: 5.41798761845 ppl: 225.425024585
epoch: 3 idx: 5650 cost: 5.55669394493 ppl: 258.965266086
epoch: 3 idx: 5700 cost: 5.53532536507 ppl: 253.490251093
epoch: 3 idx: 5750 cost: 5.49850543022 ppl: 244.32649625
epoch: 3 idx: 5800 cost: 5.53442436218 ppl: 253.261958508
epoch: 3 idx: 5850 cost: 5.53491258621 ppl: 253.385637271
epoch: 3 idx: 5900 cost: 5.43718717575 ppl: 229.794900872
epoch: 3 idx: 5950 cost: 5.48791734695 ppl: 241.753194172
epoch: 3 idx: 6000 cost: 5.37349466801 ppl: 215.615055652
validing....
valid_cost: 5.55827837377 perplexity: 259.375903349
testing...
test cost: 5.46407680892 perplexity: 236.057828003
epoch: 3 idx: 6050 cost: 5.37821707726 ppl: 216.635686206
epoch: 3 idx: 6100 cost: 5.4213339901 ppl: 226.180644083
epoch: 3 idx: 6150 cost: 5.34301467896 ppl: 209.142257633
epoch: 3 idx: 6200 cost: 5.38761224747 ppl: 218.680606497
epoch: 3 idx: 6250 cost: 5.28219499111 ppl: 196.801378883
epoch: 3 idx: 6300 cost: 5.28090493202 ppl: 196.547657168
epoch: 3 idx: 6350 cost: 5.4370117569 ppl: 229.754594049
epoch: 3 idx: 6400 cost: 5.40030272484 ppl: 221.473451572
epoch: 3 idx: 6450 cost: 5.33769827843 ppl: 208.033324004
epoch: 3 idx: 6500 cost: 5.28533509254 ppl: 197.420326445
epoch: 3 idx: 6550 cost: 5.29668006897 ppl: 199.672808412
epoch: 3 idx: 6600 cost: 5.3439253521 ppl: 209.33280462
epoch: 3 idx: 6650 cost: 5.36367717743 ppl: 213.50861378
epoch: 3 idx: 6700 cost: 5.32021965981 ppl: 204.428781848
epoch: 3 idx: 6750 cost: 5.35702674866 ppl: 212.093401054
epoch: 3 idx: 6800 cost: 5.29499499321 ppl: 199.336627927
epoch: 3 idx: 6850 cost: 5.28858335495 ppl: 198.06264211
epoch: 3 idx: 6900 cost: 5.41573026657 ppl: 224.916734893
epoch: 3 idx: 6950 cost: 5.36642137527 ppl: 214.09532832
epoch: 3 idx: 7000 cost: 5.3383561039 ppl: 208.170218645
validing....
valid_cost: 5.48767423823 perplexity: 241.694429005
epoch: 3 idx: 7050 cost: 5.29160288811 ppl: 198.66160266
epoch: 3 idx: 7100 cost: 5.26826179504 ppl: 194.078321186
epoch: 3 idx: 7150 cost: 5.42837125778 ppl: 227.777951569
epoch: 4 idx: 7200 cost: 2.9187321949 ppl: 18.5177956156
epoch: 4 idx: 7250 cost: 5.30351000786 ppl: 201.041229288
epoch: 4 idx: 7300 cost: 5.13585665703 ppl: 170.009897684
epoch: 4 idx: 7350 cost: 4.9785139823 ppl: 145.258364689
epoch: 4 idx: 7400 cost: 5.24073845863 ppl: 188.809478927
epoch: 4 idx: 7450 cost: 5.22238113403 ppl: 185.375061836
epoch: 4 idx: 7500 cost: 5.29318285942 ppl: 198.975730385
epoch: 4 idx: 7550 cost: 5.24860881805 ppl: 190.301340431
epoch: 4 idx: 7600 cost: 5.2464268589 ppl: 189.886563357
epoch: 4 idx: 7650 cost: 5.24432165146 ppl: 189.487233234
epoch: 4 idx: 7700 cost: 5.26378162384 ppl: 193.210761938
epoch: 4 idx: 7750 cost: 5.16123226643 ppl: 174.379204903
epoch: 4 idx: 7800 cost: 5.23083141804 ppl: 186.948171005
epoch: 4 idx: 7850 cost: 5.16740649223 ppl: 175.459192102
epoch: 4 idx: 7900 cost: 5.15938339233 ppl: 174.057097569
epoch: 4 idx: 7950 cost: 5.18629841805 ppl: 178.805463372
epoch: 4 idx: 8000 cost: 5.13083112717 ppl: 169.157651156
validing....
valid_cost: 5.58016931302 perplexity: 265.116489659
testing...
test cost: 5.47824363082 perplexity: 239.425817736
epoch: 4 idx: 8050 cost: 5.05216991425 ppl: 156.361387439
epoch: 4 idx: 8100 cost: 5.04981425285 ppl: 155.99348645
epoch: 4 idx: 8150 cost: 5.2113830471 ppl: 183.347461094
epoch: 4 idx: 8200 cost: 5.20085046768 ppl: 181.426473634
epoch: 4 idx: 8250 cost: 5.10469765663 ppl: 164.794238554
epoch: 4 idx: 8300 cost: 5.00096519947 ppl: 148.556476559
epoch: 4 idx: 8350 cost: 5.09501812458 ppl: 163.206802652
epoch: 4 idx: 8400 cost: 5.11159495354 ppl: 165.934802227
epoch: 4 idx: 8450 cost: 5.08451917171 ppl: 161.502265708
epoch: 4 idx: 8500 cost: 5.11226630211 ppl: 166.046239722
epoch: 4 idx: 8550 cost: 5.14641407967 ppl: 171.814272039
epoch: 4 idx: 8600 cost: 5.02477854252 ppl: 152.136560602
epoch: 4 idx: 8650 cost: 5.02118508339 ppl: 151.59084518
epoch: 4 idx: 8700 cost: 5.22184305668 ppl: 185.275342544
epoch: 4 idx: 8750 cost: 5.16056199074 ppl: 174.262361925
epoch: 4 idx: 8800 cost: 5.14759578705 ppl: 172.017426243
epoch: 4 idx: 8850 cost: 5.04481604576 ppl: 155.215743978
epoch: 4 idx: 8900 cost: 5.06997463226 ppl: 159.170289502
epoch: 4 idx: 8950 cost: 5.2162361908 ppl: 184.239435357
epoch: 5 idx: 9000 cost: 3.49970846176 ppl: 33.1057989453
validing....
valid_cost: 5.4715244203 perplexity: 237.822457952
epoch: 5 idx: 9050 cost: 5.09794789314 ppl: 163.685661943
epoch: 5 idx: 9100 cost: 4.91663794994 ppl: 136.542776972
epoch: 5 idx: 9150 cost: 4.74008692741 ppl: 114.444149582
epoch: 5 idx: 9200 cost: 4.96805324554 ppl: 143.74677513
epoch: 5 idx: 9250 cost: 4.93996513367 ppl: 139.765376369
epoch: 5 idx: 9300 cost: 5.11611423492 ppl: 166.686405364
epoch: 5 idx: 9350 cost: 5.01468714714 ppl: 150.609010935
epoch: 5 idx: 9400 cost: 5.01614556313 ppl: 150.828821773
epoch: 5 idx: 9450 cost: 5.0272305584 ppl: 152.51005959
epoch: 5 idx: 9500 cost: 5.04745474815 ppl: 155.625852973
epoch: 5 idx: 9550 cost: 4.83476221561 ppl: 125.808664314
epoch: 5 idx: 9600 cost: 5.00071832657 ppl: 148.519806517
epoch: 5 idx: 9650 cost: 4.95125067711 ppl: 141.351638676
epoch: 5 idx: 9700 cost: 4.88662626743 ppl: 132.505780042
epoch: 5 idx: 9750 cost: 5.00576891899 ppl: 149.271816977
epoch: 5 idx: 9800 cost: 4.85102263927 ppl: 127.871089003
epoch: 5 idx: 9850 cost: 4.89628120899 ppl: 133.791311484
epoch: 5 idx: 9900 cost: 4.79733232975 ppl: 121.186699771
epoch: 5 idx: 9950 cost: 5.04916690826 ppl: 155.892537589
epoch: 5 idx: 10000 cost: 4.99360298157 ppl: 147.466787593
validing....
valid_cost: 5.4116233845 perplexity: 223.99492257
testing...
test cost: 5.31667287921 perplexity: 203.705002113
epoch: 5 idx: 10050 cost: 4.83222052097 ppl: 125.489303137
epoch: 5 idx: 10100 cost: 4.83655454159 ppl: 126.034356647
epoch: 5 idx: 10150 cost: 4.867296772 ppl: 129.969105473
epoch: 5 idx: 10200 cost: 4.85951931953 ppl: 128.962197597
epoch: 5 idx: 10250 cost: 4.90914069176 ppl: 135.522908406
epoch: 5 idx: 10300 cost: 4.8712556076 ppl: 130.484651603
epoch: 5 idx: 10350 cost: 4.92494137287 ppl: 137.681269549
epoch: 5 idx: 10400 cost: 4.83884704113 ppl: 126.323621796
epoch: 5 idx: 10450 cost: 4.78360944748 ppl: 119.535027728
epoch: 5 idx: 10500 cost: 5.03879020691 ppl: 154.283251265
epoch: 5 idx: 10550 cost: 4.98819800854 ppl: 146.671883736
epoch: 5 idx: 10600 cost: 4.95526982307 ppl: 141.920894739
epoch: 5 idx: 10650 cost: 4.78912373543 ppl: 120.195999008
epoch: 5 idx: 10700 cost: 4.9374646759 ppl: 139.416335511
epoch: 5 idx: 10750 cost: 4.98851433277 ppl: 146.718286946
epoch: 6 idx: 10800 cost: 4.08525863647 ppl: 59.4573135928
epoch: 6 idx: 10850 cost: 4.89733406067 ppl: 133.93224807
epoch: 6 idx: 10900 cost: 4.57642210245 ppl: 97.1661211093
epoch: 6 idx: 10950 cost: 4.66844973564 ppl: 106.532460873
epoch: 6 idx: 11000 cost: 4.79533894539 ppl: 120.945368712
validing....
valid_cost: 5.68755839 perplexity: 295.172045079
epoch: 6 idx: 11050 cost: 4.69424109936 ppl: 109.315817311
epoch: 6 idx: 11100 cost: 4.95440793037 ppl: 141.798626855
epoch: 6 idx: 11150 cost: 4.89968641281 ppl: 134.247674733
epoch: 6 idx: 11200 cost: 4.80869597435 ppl: 122.571676646
epoch: 6 idx: 11250 cost: 4.86486116886 ppl: 129.652937497
epoch: 6 idx: 11300 cost: 4.80455247402 ppl: 122.064851604
epoch: 6 idx: 11350 cost: 4.69731105089 ppl: 109.651927228
epoch: 6 idx: 11400 cost: 4.75120774746 ppl: 115.723965486
epoch: 6 idx: 11450 cost: 4.79685522079 ppl: 121.128894302
epoch: 6 idx: 11500 cost: 4.65223186493 ppl: 104.818665813
epoch: 6 idx: 11550 cost: 4.8696628046 ppl: 130.276980691
epoch: 6 idx: 11600 cost: 4.68112359524 ppl: 107.891230565
epoch: 6 idx: 11650 cost: 4.73565645218 ppl: 113.938229173
epoch: 6 idx: 11700 cost: 4.5629249239 ppl: 95.8634635002
epoch: 6 idx: 11750 cost: 4.91868605137 ppl: 136.822717003
epoch: 6 idx: 11800 cost: 4.82788677216 ppl: 124.946640749
epoch: 6 idx: 11850 cost: 4.62057099342 ppl: 101.552001103
epoch: 6 idx: 11900 cost: 4.68618672371 ppl: 108.438882974
epoch: 6 idx: 11950 cost: 4.60661902905 ppl: 100.144989314
epoch: 6 idx: 12000 cost: 4.70799655437 ppl: 110.829895663
validing....
valid_cost: 5.52054064016 perplexity: 249.770036406
testing...
test cost: 5.39673164305 perplexity: 220.683962267
epoch: 6 idx: 12050 cost: 4.64969377041 ppl: 104.552963463

