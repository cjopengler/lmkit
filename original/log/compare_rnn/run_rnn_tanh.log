Using cuDNN version 5110 on context None
Mapped name None to device cuda3: Tesla K40m (0000:30:00.0)
Namespace(batch_size=20, bptt=-1, goto_line=0, maxlen=256, mode='train', model_dir='None', optimizer='adam', rnn_cell='rnnblock', save_freq=20000, test_file='../data/wikitext-2/idx_wiki.test.tokens', test_freq=2000, train_file='../data/wikitext-2/idx_wiki.train.tokens', valid_file='../data/wikitext-2/idx_wiki.valid.tokens', valid_freq=1000, vocab_size=33279)
loading dataset...
building model...
building rnn cell...
66048
building softmax output layer...
training start...
epoch: 0 idx: 50 cost: 8.41340524673 ppl: 4507.08213651
epoch: 0 idx: 100 cost: 7.62795196533 ppl: 2054.83732935
epoch: 0 idx: 150 cost: 7.5384875679 ppl: 1878.98603624
epoch: 0 idx: 200 cost: 7.57151416779 ppl: 1942.07868936
epoch: 0 idx: 250 cost: 7.50466234207 ppl: 1816.49180835
epoch: 0 idx: 300 cost: 7.63716960907 ppl: 2073.86565121
epoch: 0 idx: 350 cost: 7.46250741959 ppl: 1741.50928184
epoch: 0 idx: 400 cost: 7.31794400215 ppl: 1507.10218338
epoch: 0 idx: 450 cost: 7.28228167534 ppl: 1454.30248853
epoch: 0 idx: 500 cost: 7.30744063377 ppl: 1491.35537599
epoch: 0 idx: 550 cost: 7.09609848976 ppl: 1207.24778471
epoch: 0 idx: 600 cost: 7.0935729599 ppl: 1204.20269123
epoch: 0 idx: 650 cost: 6.98447490692 ppl: 1079.73930522
epoch: 0 idx: 700 cost: 6.93546960831 ppl: 1028.10194389
epoch: 0 idx: 750 cost: 6.86826972008 ppl: 961.283835882
epoch: 0 idx: 800 cost: 6.80628353119 ppl: 903.50670504
epoch: 0 idx: 850 cost: 6.72777932167 ppl: 835.290293794
epoch: 0 idx: 900 cost: 6.76746663094 ppl: 869.107333055
epoch: 0 idx: 950 cost: 6.7496981144 ppl: 853.800973393
epoch: 0 idx: 1000 cost: 6.73007929802 ppl: 837.213652706
validing....
valid_cost: 6.36631642548 perplexity: 581.910365952
epoch: 0 idx: 1050 cost: 6.58244153976 ppl: 722.300704032
epoch: 0 idx: 1100 cost: 6.63351833344 ppl: 760.151939303
epoch: 0 idx: 1150 cost: 6.52210837364 ppl: 680.010591403
epoch: 0 idx: 1200 cost: 6.58437315941 ppl: 723.697262636
epoch: 0 idx: 1250 cost: 6.72911279678 ppl: 836.404875581
epoch: 0 idx: 1300 cost: 6.44532167435 ppl: 629.749218553
epoch: 0 idx: 1350 cost: 6.44972723961 ppl: 632.529740221
epoch: 0 idx: 1400 cost: 6.42169980049 ppl: 615.04768445
epoch: 0 idx: 1450 cost: 6.53340261459 ppl: 687.73432965
epoch: 0 idx: 1500 cost: 6.44840802193 ppl: 631.695845968
epoch: 0 idx: 1550 cost: 6.38241137505 ppl: 591.351961126
epoch: 0 idx: 1600 cost: 6.32582856178 ppl: 558.820639324
epoch: 0 idx: 1650 cost: 6.39889204025 ppl: 601.178587065
epoch: 0 idx: 1700 cost: 6.28459956169 ppl: 536.24951279
epoch: 0 idx: 1750 cost: 6.36434256554 ppl: 580.762889242
epoch: 1 idx: 1800 cost: 0.876029882431 ppl: 2.40134712612
epoch: 1 idx: 1850 cost: 6.17621247292 ppl: 481.166071214
epoch: 1 idx: 1900 cost: 6.09099347115 ppl: 441.860168491
epoch: 1 idx: 1950 cost: 5.94487960339 ppl: 381.793391899
epoch: 1 idx: 2000 cost: 5.97994377136 ppl: 395.418133707
validing....
valid_cost: 5.85424766025 perplexity: 348.712451103
testing...
test cost: 5.76976057957 perplexity: 320.460998552
epoch: 1 idx: 2050 cost: 6.1512135601 ppl: 469.28654879
epoch: 1 idx: 2100 cost: 6.16430797577 ppl: 475.471990919
epoch: 1 idx: 2150 cost: 6.08442455292 ppl: 438.967137621
epoch: 1 idx: 2200 cost: 5.98227639198 ppl: 396.341570795
epoch: 1 idx: 2250 cost: 6.01128878593 ppl: 408.0088176
epoch: 1 idx: 2300 cost: 6.04607481003 ppl: 422.451568741
epoch: 1 idx: 2350 cost: 5.8669288826 ppl: 353.162708947
epoch: 1 idx: 2400 cost: 5.9433655262 ppl: 381.215764631
epoch: 1 idx: 2450 cost: 5.90880401611 ppl: 368.265452378
epoch: 1 idx: 2500 cost: 5.90783117294 ppl: 367.907362059
epoch: 1 idx: 2550 cost: 5.83527801514 ppl: 342.159846445
epoch: 1 idx: 2600 cost: 5.86356661797 ppl: 351.977276447
epoch: 1 idx: 2650 cost: 5.79480608463 ppl: 328.588459452
epoch: 1 idx: 2700 cost: 5.88665166855 ppl: 360.197203348
epoch: 1 idx: 2750 cost: 5.84876755714 ppl: 346.806697549
epoch: 1 idx: 2800 cost: 5.87374259949 ppl: 355.577276409
epoch: 1 idx: 2850 cost: 5.81657520294 ppl: 335.81996669
epoch: 1 idx: 2900 cost: 5.83519069672 ppl: 342.129970892
epoch: 1 idx: 2950 cost: 5.73554885864 ppl: 309.682896256
epoch: 1 idx: 3000 cost: 5.83314613342 ppl: 341.431179117
validing....
valid_cost: 5.81248997224 perplexity: 334.450863109
epoch: 1 idx: 3050 cost: 5.89750328064 ppl: 364.127208556
epoch: 1 idx: 3100 cost: 5.83976491928 ppl: 343.698534269
epoch: 1 idx: 3150 cost: 5.81248070717 ppl: 334.447764411
epoch: 1 idx: 3200 cost: 5.75911014557 ppl: 317.066060709
epoch: 1 idx: 3250 cost: 5.8083472538 ppl: 333.068193333
epoch: 1 idx: 3300 cost: 5.86661124229 ppl: 353.050548051
epoch: 1 idx: 3350 cost: 5.79942328453 ppl: 330.109125962
epoch: 1 idx: 3400 cost: 5.75738811493 ppl: 316.52053308
epoch: 1 idx: 3450 cost: 5.78649010658 ppl: 325.867255454
epoch: 1 idx: 3500 cost: 5.72699193001 ppl: 307.044267194
epoch: 1 idx: 3550 cost: 5.83119149208 ppl: 340.764455434
epoch: 2 idx: 3600 cost: 1.62808795929 ppl: 5.09412522598
epoch: 2 idx: 3650 cost: 5.74346918106 ppl: 312.145423775
epoch: 2 idx: 3700 cost: 5.59571503162 ppl: 269.270117923
epoch: 2 idx: 3750 cost: 5.58481435299 ppl: 266.350830914
epoch: 2 idx: 3800 cost: 5.60252883434 ppl: 271.111136431
epoch: 2 idx: 3850 cost: 5.7379069519 ppl: 310.414019097
epoch: 2 idx: 3900 cost: 5.73267707825 ppl: 308.794830761
epoch: 2 idx: 3950 cost: 5.63863335609 ppl: 281.078321893
epoch: 2 idx: 4000 cost: 5.59940256119 ppl: 270.264892447
validing....
valid_cost: 5.60591634158 perplexity: 272.031084652
testing...
test cost: 5.53149137586 perplexity: 252.520232916
epoch: 2 idx: 4050 cost: 5.60342069626 ppl: 271.353037984
epoch: 2 idx: 4100 cost: 5.5881698513 ppl: 267.246071827
epoch: 2 idx: 4150 cost: 5.47510663033 ppl: 238.675915664
epoch: 2 idx: 4200 cost: 5.45036218166 ppl: 232.842481915
epoch: 2 idx: 4250 cost: 5.48155107498 ppl: 240.219016266
epoch: 2 idx: 4300 cost: 5.48822693825 ppl: 241.828050443
epoch: 2 idx: 4350 cost: 5.40224895477 ppl: 221.904909555
epoch: 2 idx: 4400 cost: 5.51380738258 ppl: 248.093919611
epoch: 2 idx: 4450 cost: 5.3414918375 ppl: 208.824009516
epoch: 2 idx: 4500 cost: 5.45111863136 ppl: 233.018682176
epoch: 2 idx: 4550 cost: 5.50303790092 ppl: 245.436412367
epoch: 2 idx: 4600 cost: 5.51427541733 ppl: 248.210063363
epoch: 2 idx: 4650 cost: 5.43473394394 ppl: 229.231851638
epoch: 2 idx: 4700 cost: 5.4442305851 ppl: 231.419153849
epoch: 2 idx: 4750 cost: 5.39230855465 ppl: 219.710013113
epoch: 2 idx: 4800 cost: 5.43164506912 ppl: 228.524875587
epoch: 2 idx: 4850 cost: 5.51315391541 ppl: 247.931851337
epoch: 2 idx: 4900 cost: 5.42957860947 ppl: 228.053125745
epoch: 2 idx: 4950 cost: 5.46666669846 ppl: 236.669984068
epoch: 2 idx: 5000 cost: 5.41024300575 ppl: 223.685938046
validing....
valid_cost: 5.56473284799 perplexity: 261.055452903
epoch: 2 idx: 5050 cost: 5.4069822979 ppl: 222.957751398
epoch: 2 idx: 5100 cost: 5.55538363457 ppl: 258.626163428
epoch: 2 idx: 5150 cost: 5.42631362915 ppl: 227.309750991
epoch: 2 idx: 5200 cost: 5.44281605721 ppl: 231.092036414
epoch: 2 idx: 5250 cost: 5.38269759178 ppl: 217.608503278
epoch: 2 idx: 5300 cost: 5.41137661934 ppl: 223.939655246
epoch: 2 idx: 5350 cost: 5.4973681736 ppl: 244.048792264
epoch: 3 idx: 5400 cost: 2.26675572395 ppl: 9.64804905025
epoch: 3 idx: 5450 cost: 5.45855790138 ppl: 234.758635037
epoch: 3 idx: 5500 cost: 5.33153443813 ppl: 206.754983609
epoch: 3 idx: 5550 cost: 5.25649091721 ppl: 191.807241499
epoch: 3 idx: 5600 cost: 5.34474228859 ppl: 209.503886099
epoch: 3 idx: 5650 cost: 5.44433693886 ppl: 231.443767455
epoch: 3 idx: 5700 cost: 5.39416651726 ppl: 220.118605559
epoch: 3 idx: 5750 cost: 5.31508400917 ppl: 203.381598331
epoch: 3 idx: 5800 cost: 5.33795138359 ppl: 208.085984977
epoch: 3 idx: 5850 cost: 5.34734353065 ppl: 210.049565835
epoch: 3 idx: 5900 cost: 5.27258599758 ppl: 194.919372282
epoch: 3 idx: 5950 cost: 5.24672759056 ppl: 189.943676846
epoch: 3 idx: 6000 cost: 5.14226192951 ppl: 171.102352404
validing....
valid_cost: 5.61649127329 perplexity: 274.923059061
testing...
test cost: 5.52981556973 perplexity: 252.097412342
epoch: 3 idx: 6050 cost: 5.17466357231 ppl: 176.737145004
epoch: 3 idx: 6100 cost: 5.2147778511 ppl: 183.970947497
epoch: 3 idx: 6150 cost: 5.14995975494 ppl: 172.424550941
epoch: 3 idx: 6200 cost: 5.2088196373 ppl: 182.878068295
epoch: 3 idx: 6250 cost: 5.09258491993 ppl: 162.810169841
epoch: 3 idx: 6300 cost: 5.13574959755 ppl: 169.991697488
epoch: 3 idx: 6350 cost: 5.24677304268 ppl: 189.952310384
epoch: 3 idx: 6400 cost: 5.25268939972 ppl: 191.079467116
epoch: 3 idx: 6450 cost: 5.15851595879 ppl: 173.906180068
epoch: 3 idx: 6500 cost: 5.128749156 ppl: 168.805836164
epoch: 3 idx: 6550 cost: 5.1255588913 ppl: 168.268158986
epoch: 3 idx: 6600 cost: 5.15405003548 ppl: 173.13126006
epoch: 3 idx: 6650 cost: 5.20440198421 ppl: 182.071958301
epoch: 3 idx: 6700 cost: 5.17377832413 ppl: 176.580757998
epoch: 3 idx: 6750 cost: 5.20035301208 ppl: 181.336244463
epoch: 3 idx: 6800 cost: 5.0640822506 ppl: 158.235155196
epoch: 3 idx: 6850 cost: 5.18154443741 ppl: 177.957442995
epoch: 3 idx: 6900 cost: 5.30480741024 ppl: 201.302229932
epoch: 3 idx: 6950 cost: 5.20237574577 ppl: 181.703410608
epoch: 3 idx: 7000 cost: 5.17377198219 ppl: 176.579638138
validing....
valid_cost: 5.52550272877 perplexity: 251.012497511
epoch: 3 idx: 7050 cost: 5.14405110836 ppl: 171.40875914
epoch: 3 idx: 7100 cost: 5.11171004772 ppl: 165.953901457
epoch: 3 idx: 7150 cost: 5.26423399925 ppl: 193.298185509
epoch: 4 idx: 7200 cost: 2.85696362495 ppl: 17.4085876044
epoch: 4 idx: 7250 cost: 5.22731490135 ppl: 186.291919179
epoch: 4 idx: 7300 cost: 5.08019932747 ppl: 160.806105808
epoch: 4 idx: 7350 cost: 4.98142896652 ppl: 145.682408271
epoch: 4 idx: 7400 cost: 5.19508495331 ppl: 180.383466318
epoch: 4 idx: 7450 cost: 5.1395021677 ppl: 170.630801649
epoch: 4 idx: 7500 cost: 5.16525799751 ppl: 175.082623627
epoch: 4 idx: 7550 cost: 5.12446310997 ppl: 168.083874866
epoch: 4 idx: 7600 cost: 5.09282369614 ppl: 162.849049678
epoch: 4 idx: 7650 cost: 5.09600634575 ppl: 163.368166788
epoch: 4 idx: 7700 cost: 5.13724879265 ppl: 170.246739338
epoch: 4 idx: 7750 cost: 4.95454783916 ppl: 141.818467117
epoch: 4 idx: 7800 cost: 4.99199509621 ppl: 147.229868425
epoch: 4 idx: 7850 cost: 4.99416377068 ppl: 147.549508554
epoch: 4 idx: 7900 cost: 5.00065609455 ppl: 148.510564118
epoch: 4 idx: 7950 cost: 5.01721636772 ppl: 150.990416471
epoch: 4 idx: 8000 cost: 4.94130014896 ppl: 139.952089889
validing....
valid_cost: 5.92316516412 perplexity: 373.592325501
testing...
test cost: 5.82154218468 perplexity: 337.49212769
epoch: 4 idx: 8050 cost: 4.90916028738 ppl: 135.525564088
epoch: 4 idx: 8100 cost: 4.90004183292 ppl: 134.295397537
epoch: 4 idx: 8150 cost: 5.05224977493 ppl: 156.373875065
epoch: 4 idx: 8200 cost: 5.07511961937 ppl: 159.991328897
epoch: 4 idx: 8250 cost: 4.96138773441 ppl: 142.791815582
epoch: 4 idx: 8300 cost: 4.84468082428 ppl: 127.062720186
epoch: 4 idx: 8350 cost: 4.91921752453 ppl: 136.895453932
epoch: 4 idx: 8400 cost: 4.9406960392 ppl: 139.867568998
epoch: 4 idx: 8450 cost: 4.95367464066 ppl: 141.694685494
epoch: 4 idx: 8500 cost: 5.01611015797 ppl: 150.823481749
epoch: 4 idx: 8550 cost: 4.98136909962 ppl: 145.673686977
epoch: 4 idx: 8600 cost: 4.851252985 ppl: 127.900546955
epoch: 4 idx: 8650 cost: 4.8923695755 ppl: 133.268991138
epoch: 4 idx: 8700 cost: 5.10397350788 ppl: 164.67494621
epoch: 4 idx: 8750 cost: 5.02743532658 ppl: 152.541291995
epoch: 4 idx: 8800 cost: 5.00034404755 ppl: 148.464229071
epoch: 4 idx: 8850 cost: 4.88938931465 ppl: 132.872406038
epoch: 4 idx: 8900 cost: 4.9486073494 ppl: 140.978493362
epoch: 4 idx: 8950 cost: 5.06665936947 ppl: 158.643471915
epoch: 5 idx: 9000 cost: 3.42749016285 ppl: 30.7992445737
validing....
valid_cost: 5.56998564617 perplexity: 262.430332333
epoch: 5 idx: 9050 cost: 5.03546383858 ppl: 153.770900949
epoch: 5 idx: 9100 cost: 4.89496142387 ppl: 133.614852172
epoch: 5 idx: 9150 cost: 4.75446025133 ppl: 116.100970905
epoch: 5 idx: 9200 cost: 4.90326545715 ppl: 134.729013967
epoch: 5 idx: 9250 cost: 4.8486096096 ppl: 127.562904251
epoch: 5 idx: 9300 cost: 5.04920880795 ppl: 155.899069573
epoch: 5 idx: 9350 cost: 4.9318897295 ppl: 138.641259424
epoch: 5 idx: 9400 cost: 4.88070055008 ppl: 131.722910066
epoch: 5 idx: 9450 cost: 4.90114738464 ppl: 134.443950145
epoch: 5 idx: 9500 cost: 4.94579986572 ppl: 140.583253618
epoch: 5 idx: 9550 cost: 4.66775415421 ppl: 106.458384637
epoch: 5 idx: 9600 cost: 4.89346206665 ppl: 133.414665891
epoch: 5 idx: 9650 cost: 4.83353488445 ppl: 125.654350137
epoch: 5 idx: 9700 cost: 4.75625367165 ppl: 116.309375568
epoch: 5 idx: 9750 cost: 4.88036593437 ppl: 131.678840884
epoch: 5 idx: 9800 cost: 4.70886764526 ppl: 110.926480637
epoch: 5 idx: 9850 cost: 4.81099467993 ppl: 122.853756928
epoch: 5 idx: 9900 cost: 4.66523243427 ppl: 106.190264611
epoch: 5 idx: 9950 cost: 4.93231675148 ppl: 138.700474932
epoch: 5 idx: 10000 cost: 4.87127285957 ppl: 130.486902739
validing....
valid_cost: 5.56356763711 perplexity: 260.751445401
testing...
test cost: 5.47589962807 perplexity: 238.865260192
epoch: 5 idx: 10050 cost: 4.67985938549 ppl: 107.754919601
epoch: 5 idx: 10100 cost: 4.71512816429 ppl: 111.623116355
epoch: 5 idx: 10150 cost: 4.70666832924 ppl: 110.682786329
epoch: 5 idx: 10200 cost: 4.70485450268 ppl: 110.482208912
epoch: 5 idx: 10250 cost: 4.81528254032 ppl: 123.381667682
epoch: 5 idx: 10300 cost: 4.77161482811 ppl: 118.109815097
epoch: 5 idx: 10350 cost: 4.79908571243 ppl: 121.399372826
epoch: 5 idx: 10400 cost: 4.71199315071 ppl: 111.273724329
epoch: 5 idx: 10450 cost: 4.65984867096 ppl: 105.620097559
epoch: 5 idx: 10500 cost: 4.93425909996 ppl: 138.970141397
epoch: 5 idx: 10550 cost: 4.86578899384 ppl: 129.773288554
epoch: 5 idx: 10600 cost: 4.84732800484 ppl: 127.399523741
epoch: 5 idx: 10650 cost: 4.65172403336 ppl: 104.765449099
epoch: 5 idx: 10700 cost: 4.87342550755 ppl: 130.768097654
epoch: 5 idx: 10750 cost: 4.86173594475 ppl: 129.248375513
epoch: 6 idx: 10800 cost: 4.00676495075 ppl: 54.9687559814
epoch: 6 idx: 10850 cost: 4.83971981049 ppl: 126.433921308
epoch: 6 idx: 10900 cost: 4.56373780489 ppl: 95.9414207683
epoch: 6 idx: 10950 cost: 4.66627708435 ppl: 106.301254241
epoch: 6 idx: 11000 cost: 4.74964883804 ppl: 115.543702849
validing....
valid_cost: 5.77477474342 perplexity: 322.071877736
epoch: 6 idx: 11050 cost: 4.5914179945 ppl: 98.6341937907
epoch: 6 idx: 11100 cost: 4.90756142616 ppl: 135.309050653
epoch: 6 idx: 11150 cost: 4.82560579777 ppl: 124.661965453
epoch: 6 idx: 11200 cost: 4.68854279518 ppl: 108.694673945
epoch: 6 idx: 11250 cost: 4.76713348389 ppl: 117.581708557
epoch: 6 idx: 11300 cost: 4.74446107388 ppl: 114.945841491
epoch: 6 idx: 11350 cost: 4.57922849894 ppl: 97.4391907616
epoch: 6 idx: 11400 cost: 4.65734111786 ppl: 105.355581339
epoch: 6 idx: 11450 cost: 4.71370172977 ppl: 111.464006795
epoch: 6 idx: 11500 cost: 4.53848289967 ppl: 93.5487695399
epoch: 6 idx: 11550 cost: 4.76087468147 ppl: 116.84808607
epoch: 6 idx: 11600 cost: 4.60151460171 ppl: 99.6351089233
epoch: 6 idx: 11650 cost: 4.6508725667 ppl: 104.676282779
epoch: 6 idx: 11700 cost: 4.4213559103 ppl: 83.2090328881
epoch: 6 idx: 11750 cost: 4.87840690136 ppl: 131.421130202
epoch: 6 idx: 11800 cost: 4.71778058052 ppl: 111.919580319
epoch: 6 idx: 11850 cost: 4.46474987984 ppl: 86.8992915563
epoch: 6 idx: 11900 cost: 4.57223632813 ppl: 96.7602556773
epoch: 6 idx: 11950 cost: 4.46536717415 ppl: 86.9529505547
epoch: 6 idx: 12000 cost: 4.56305302143 ppl: 95.8757441601
validing....
valid_cost: 5.65636210442 perplexity: 286.105923579
testing...
test cost: 5.53971428714 perplexity: 254.605245074
epoch: 6 idx: 12050 cost: 4.54057383537 ppl: 93.7445786432

